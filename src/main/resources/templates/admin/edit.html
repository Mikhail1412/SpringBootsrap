<!doctype html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout :: layout('Edit user', ~{::section})}">

<section>
    <h3 class="mb-3">Edit user</h3>

    <form th:action="@{/admin/update/{id}(id=${user.id})}" method="post" class="row g-3">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

        <div class="col-md-6">
            <label class="form-label">First name</label>
            <input class="form-control" name="firstName" th:value="${user.firstName}" required>
        </div>

        <div class="col-md-6">
            <label class="form-label">Last name</label>
            <input class="form-control" name="lastName" th:value="${user.lastName}" required>
        </div>

        <div class="col-md-6">
            <label class="form-label">Age</label>
            <input class="form-control" name="age" type="number" min="0" max="150"
                   th:value="${user.age}" required>
        </div>

        <div class="col-md-6">
            <label class="form-label">Email</label>
            <input class="form-control" name="email" type="email" th:value="${user.email}" required>
        </div>

        <div class="col-md-6">
            <label class="form-label">Password (оставь пустым — не изменится)</label>
            <input class="form-control" name="password" type="password">
        </div>

        <div class="col-12">
            <label class="form-label">Roles</label>
            <select class="form-select"
                    name="roleIds"
                    multiple
                    size="2"
                    required>
                <option th:each="r : ${roles}"
                        th:value="${r.id}"
                        th:selected="${selectedRoleIds != null and selectedRoleIds.contains(r.id)}"
                        th:text="${r.name}">ROLE_USER</option>
            </select>
            <div class="text-danger small mt-1" th:if="${errorRoles}" th:text="${errorRoles}"></div>
        </div>

        <div class="col-12 d-flex gap-2">
            <a class="btn btn-outline-secondary" th:href="@{/admin}">Cancel</a>
            <button class="btn btn-primary" type="submit">Save</button>
        </div>
    </form>
</section>

</html>